Usage example:

Add the following keys to your app.config:

<appSettings>
  <add key="EmailClient.SMTP" value="{your-smtp-server}" />
  <add key="EmailClient.Account" value="{your-email-account}" />
  <add key="EmailClient.Password" value="{your-email-password}" />
  <add key="EmailClient.Templates.Path" value="{your-templates-path}" />
</appSettings>


Usage with subject and body as strings:

var emailFactory = new EmailFactory();
var emailSender = new EmailSender();
var isHtml = false;

var email = emailFactory.CreateFor(isHtml, "subject", "body", "first-recipient", "second-recipient");

emailSender.Send(email);


Usage with subject and body as templates:

var emailFactory = new EmailFactory();
var emailSender = new EmailSender();
var isHtml = false;

var email = emailFactory.CreateWithTemplateFor(isHtml, 
                                               "subjectTemplateName", 
                                               "bodyTemplateName", 
                                               "first-recipient", "second-recipient");

emailSender.Send(email);